
gc .\input.txt |sort -Unique > unique.txt

foreach($line in Get-Content .\unique.txt) {

$parent=$(Split-path -parent $line);

   if($line -match ".dll$"){
        
        echo "copy C:\\BIN\\test64.dll $line";
        New-Item -ItemType directory "$parent" -Force
        copy "C:\\BIN\\test64.dll" "$line";
    }
      if($line -match ".exe$"){
        echo "copy C:\\BIN\test64.exe $line";
        New-Item -ItemType directory "$parent" -Force
        copy  "C:\\BIN\\test64.exe" "$line";
    }

          if($line -match ".msi$"){
        echo "copy C:\\BIN\test.msi $line";
        New-Item -ItemType directory "$parent" -Force
        copy  "C:\\BIN\\test64.msi" "$line";
    }
  
}